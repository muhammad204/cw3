(function(){"use strict";var t={5080:function(t,e,o){var r=o(5130),n=o(6768),s=o(4232);const i={id:"app",class:"container"},a=["textContent"],c=["disabled"],u=(0,n.Lk)("br",null,null,-1),l={class:"row m-3"},d={key:0},h={class:"form-group col-md-6"},m=(0,n.Lk)("label",{for:""},"Sort by",-1),p=(0,n.Lk)("option",{value:"title"},"Title",-1),v=(0,n.Lk)("option",{value:"location"},"Location",-1),f=(0,n.Lk)("option",{value:"price"},"Price",-1),C=(0,n.Lk)("option",{value:"spaces"},"Spaces",-1),b=[p,v,f,C],k=(0,n.Lk)("br",null,null,-1),y=(0,n.Lk)("option",{value:"asc"},"Ascending",-1),L=(0,n.Lk)("option",{value:"desc"},"Descending",-1),w=[y,L],g={class:"col-md-6"},O={key:1};function N(t,e,o,p,v,f){const C=(0,n.g2)("course-list"),y=(0,n.g2)("checkout");return(0,n.uX)(),(0,n.CE)("div",i,[(0,n.Lk)("h1",{textContent:(0,s.v_)(v.sitename),class:"mt-5"},null,8,a),(0,n.Lk)("div",null,[(0,n.Lk)("button",{disabled:0==v.cart.length,onClick:e[0]||(e[0]=(...t)=>f.showCheckout&&f.showCheckout(...t)),class:"btn btn-outline-success btn-lg float-end m-4 p-2"}," Checkout "+(0,s.v_)(f.cartItemCount),9,c),u,(0,n.Lk)("div",l,[(0,n.Lk)("main",null,[v.showCourse?((0,n.uX)(),(0,n.CE)("div",d,[(0,n.Lk)("div",h,[m,(0,n.bo)((0,n.Lk)("select",{"onUpdate:modelValue":e[1]||(e[1]=t=>v.sortOption=t),class:"form-control",style:{width:"350px"}},b,512),[[r.u1,v.sortOption]]),k,(0,n.bo)((0,n.Lk)("select",{"onUpdate:modelValue":e[2]||(e[2]=t=>v.sortOrder=t),class:"form-control",style:{width:"350px"}},w,512),[[r.u1,v.sortOrder]])]),(0,n.Lk)("div",g,[(0,n.bo)((0,n.Lk)("input",{class:"form-control",type:"text","onUpdate:modelValue":e[3]||(e[3]=t=>v.searchQuery=t),placeholder:"Search lessons..."},null,512),[[r.Jo,v.searchQuery]])]),(0,n.bF)(C,{is:v.currentComponent,onAddcourse:f.addToCart,onCanCart:f.canAddToCart,onCartcounter:f.cartCount},null,8,["is","onAddcourse","onCanCart","onCartcounter"])])):((0,n.uX)(),(0,n.CE)("div",O,[(0,n.bF)(y,{cart:v.cart,onCartCount:f.cartCount,onRemoveItem:f.removeFromCart,onSubmitForm:f.submitForm},null,8,["cart","onCartCount","onRemoveItem","onSubmitForm"])]))])])])])}o(4114);const I={class:"row m-4"},E={class:"card md-4 m-2 shadow"},x=["src"],A={class:"card-body"},F=["textContent"],T=["innerHTML"],_=["onClick"],j={key:1,disabled:"disabled"},X={key:2},S={key:3},P={key:4};function Q(t,e,o,r,i,a){return(0,n.uX)(),(0,n.CE)("div",I,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(a.sortedCourses,(t=>((0,n.uX)(),(0,n.CE)("div",{class:"col-md-4",key:t.id},[(0,n.Lk)("div",E,[(0,n.Lk)("img",{src:"https://cw-2-smoky.vercel.app/"+t.image,class:"ct height: 300px; width: 100%; mx-auto d-block img-fluid"},null,8,x),(0,n.Lk)("div",A,[(0,n.Lk)("h2",{textContent:(0,s.v_)(t.title)},null,8,F),(0,n.Lk)("p",{innerHTML:t.description},null,8,T),(0,n.Lk)("p",null,"Location: "+(0,s.v_)(t.location),1),(0,n.Lk)("p",null,"Price: "+(0,s.v_)(t.price),1),(0,n.Lk)("p",null," Available stock: "+(0,s.v_)(t.availableInventory-a.cartCount(t.id)),1),a.canAddToCart(t)?((0,n.uX)(),(0,n.CE)("button",{key:0,onClick:e=>a.addItem(t),class:"btn btn-outline-info"}," Add to cart ",8,_)):((0,n.uX)(),(0,n.CE)("button",j,"Add to cart")),t.availableInventory===a.cartCount(t.id)?((0,n.uX)(),(0,n.CE)("span",X," All out! ")):t.availableInventory-a.cartCount(t.id)<5?((0,n.uX)(),(0,n.CE)("span",S," Only "+(0,s.v_)(t.availableInventory-a.cartCount(t.id))+" left! ",1)):((0,n.uX)(),(0,n.CE)("span",P,"Buy now!"))])])])))),128))])}var $={name:"courseList",props:["addcourse","canCart"],data(){return{sitename:"Welcome to After School!",courses:[],searchQuery:"",cart:[],showCourse:!0,sortOption:"title",sortOrder:"asc"}},created(){this.getCourses()},methods:{async getCourses(){var t="https://cw-2-smoky.vercel.app/collection/courses/",e=await fetch(t);e=await e.json(),this.courses=e,console.log("fetched")},addItem(t){this.$emit("addcourse",t)},canAddToCart(t){return t.availableInventory>this.cartCount(t.id)},cartCount(t){let e=0;for(let o=0;o<this.cart.length;o++)this.cart[o]===t&&e++;return e}},computed:{cartItemCount(){return this.cart.length},cartCourses(){const t={};return this.cart.forEach((e=>{if(t[e])t[e].count++;else{const o=this.courses.find((t=>t.id===e));o&&(t[e]={course:o,count:1})}})),Object.values(t)},sortedCourses(){var t=this.courses,e="asc"===this.sortOrder?1:-1;if(this.searchQuery){var o=this.searchQuery.toLowerCase();t=t.filter((t=>t.title.toLowerCase().includes(o)||t.location.toLowerCase().includes(o)))}return t.sort(((t,o)=>t[this.sortOption]>o[this.sortOption]?1*e:t[this.sortOption]<o[this.sortOption]?-1*e:0))}}},J=o(1241);const U=(0,J.A)($,[["render",Q]]);var V=U;const M=(0,n.Lk)("h2",null,"Shopping cart",-1),R={class:"row"},z=["src"],H={class:"card-body"},K=["onClick"],W=(0,n.Lk)("h2",null,"Checkout",-1),Z=(0,n.Lk)("strong",null,"First Name:",-1),B=(0,n.Lk)("strong",null,"Phone Number:",-1),D=(0,n.Lk)("h2",null,"Order Information",-1),q=["disabled"];function G(t,e,o,i,a,c){return(0,n.uX)(),(0,n.CE)("div",null,[M,(0,n.Lk)("ul",R,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(o.cart,(t=>((0,n.uX)(),(0,n.CE)("li",{key:t.id,class:"card col-md-3 m-2 shadow"},[(0,n.Lk)("img",{src:t.image,class:"ct height: 300px; width: 100%; mx-auto d-block img-fluid"},null,8,z),(0,n.Lk)("div",H,[(0,n.Lk)("h2",null,(0,s.v_)(t.title),1),(0,n.Lk)("p",null,"Location: "+(0,s.v_)(t.location),1),(0,n.Lk)("p",null,"Price: "+(0,s.v_)(t.price),1),(0,n.Lk)("p",null,"Quantity: "+(0,s.v_)(t.count),1),(0,n.Lk)("button",{onClick:e=>c.removeItem(t),class:"btn btn-outline-danger"}," Remove ",8,K)])])))),128))]),W,(0,n.Lk)("p",null,[Z,(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>a.order.firstName=t),id:"firstName",type:"text",class:"form-control-sm",pattern:"^[a-zA-Z\\s]+$"},null,512),[[r.Jo,a.order.firstName,void 0,{trim:!0}]])]),(0,n.Lk)("p",null,[B,(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>a.order.phoneNumber=t),id:"phoneNumber",type:"number",class:"form-control-sm"},null,512),[[r.Jo,a.order.phoneNumber,void 0,{number:!0}]])]),D,(0,n.Lk)("p",null,"First Name: "+(0,s.v_)(a.order.firstName),1),(0,n.Lk)("p",null,"phone Number: "+(0,s.v_)(a.order.phoneNumber),1),(0,n.Lk)("button",{type:"submit",disabled:!c.validInput,onClick:e[2]||(e[2]=(...t)=>c.submitForm&&c.submitForm(...t))}," Place Order ",8,q)])}var Y={name:"Form-Component",props:["cart"],data(){return{order:{firstName:"",phoneNumber:""}}},methods:{removeItem(t){this.$emit("remove-item",t)},submitForm(){this.$emit("submit-form",{Name:this.order.firstName,PhoneNumber:this.order.phoneNumber}),console.log("Form submitted with:",this.name,this.address),this.name="",this.address=""},async checkout(){var t={courses:[...this.cart],firstName:this.order.firstName,phoneNumber:this.order.phoneNumber};this.cart.forEach((t=>{t=this.courses.filter((e=>e.id==t))[0],t.availableInventory-=this.cartCount(t.id),fetch(`https://cw-2-smoky.vercel.app/collection/courses/${t._id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({availableInventory:t.availableInventory})})})),await fetch("https://cw-2-smoky.vercel.app/collection/orders/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),alert("order successful"),this.showCourse=!0}},computed:{validInput(){return/^[a-zA-Z\s]+$/.test(this.order.firstName)&&/^\d+$/.test(this.order.phoneNumber)}}};const tt=(0,J.A)(Y,[["render",G]]);var et=tt,ot={name:"app",data(){return{currentComponent:"courseList",sitename:"Welcome to After School!",courses:[],searchQuery:"",cart:[],showCourse:!0,sortOption:"title",sortOrder:"asc",order:{firstName:"",phoneNumber:""}}},components:{courseList:V,checkout:et},created(){this.getCourses()},methods:{toggleComponent(){this.currentComponent="courseList"===this.currectComponent?"checkout":"courseList"},async getCourses(){var t="https://cw-2-smoky.vercel.app/collection/courses/",e=await fetch(t);e=await e.json(),this.courses=e,console.log("fetched")},async searchCourses(){var t={search:this.searchQuery,sort:this.sortOption,order:this.sortOrder},e=await fetch("https://cw-2-smoky.vercel.app/collection/courses/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});e=await e.json(),this.courses=e,console.log("fetched")},addToCart(t){this.cart.push(t),t.availableInventory--},removeFromCart(t){const e=this.cart.indexOf(t);-1!==e&&this.cart.splice(e,1)},showCheckout(){this.showCourse=!this.showCourse},submitForm(){alert("Order submitted!")},canAddToCart(t){return t.availableInventory>this.cartCount(t.id)},cartCount(t){let e=0;for(let o=0;o<this.cart.length;o++)this.cart[o]===t&&e++;return e}},computed:{cartItemCount(){return this.cart.length},cartCourses(){const t={};return this.cart.forEach((e=>{if(t[e])t[e].count++;else{const o=this.courses.find((t=>t.id===e));o&&(t[e]={course:o,count:1})}})),Object.values(t)},sortedCourses(){var t=this.courses,e="asc"===this.sortOrder?1:-1;if(this.searchQuery){var o=this.searchQuery.toLowerCase();t=t.filter((t=>t.title.toLowerCase().includes(o)||t.location.toLowerCase().includes(o)))}return t.sort(((t,o)=>t[this.sortOption]>o[this.sortOption]?1*e:t[this.sortOption]<o[this.sortOption]?-1*e:0))}}};const rt=(0,J.A)(ot,[["render",N]]);var nt=rt;(0,r.Ef)(nt).mount("#app")}},e={};function o(r){var n=e[r];if(void 0!==n)return n.exports;var s=e[r]={exports:{}};return t[r].call(s.exports,s,s.exports,o),s.exports}o.m=t,function(){var t=[];o.O=function(e,r,n,s){if(!r){var i=1/0;for(l=0;l<t.length;l++){r=t[l][0],n=t[l][1],s=t[l][2];for(var a=!0,c=0;c<r.length;c++)(!1&s||i>=s)&&Object.keys(o.O).every((function(t){return o.O[t](r[c])}))?r.splice(c--,1):(a=!1,s<i&&(i=s));if(a){t.splice(l--,1);var u=n();void 0!==u&&(e=u)}}return e}s=s||0;for(var l=t.length;l>0&&t[l-1][2]>s;l--)t[l]=t[l-1];t[l]=[r,n,s]}}(),function(){o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,{a:e}),e}}(),function(){o.d=function(t,e){for(var r in e)o.o(e,r)&&!o.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={524:0};o.O.j=function(e){return 0===t[e]};var e=function(e,r){var n,s,i=r[0],a=r[1],c=r[2],u=0;if(i.some((function(e){return 0!==t[e]}))){for(n in a)o.o(a,n)&&(o.m[n]=a[n]);if(c)var l=c(o)}for(e&&e(r);u<i.length;u++)s=i[u],o.o(t,s)&&t[s]&&t[s][0](),t[s]=0;return o.O(l)},r=self["webpackChunkcw3"]=self["webpackChunkcw3"]||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))}();var r=o.O(void 0,[504],(function(){return o(5080)}));r=o.O(r)})();
//# sourceMappingURL=app.19790972.js.map